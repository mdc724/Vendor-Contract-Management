<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="DELETE">
        <category>custom</category>
        <client_script><![CDATA[function ($scope, $http, spScUtil, spUtil, nowAttachmentHandler, $rootScope, $sanitize, $window, $sce, i18n, $timeout, $log, spAriaUtil, $document, spModal) {
	var c = this;
	c.quantity = c.data.quantity ? parseInt(c.data.quantity) : 1;
	c.mandatory = [];
	$scope.stickyHeaderTop = '0px';

	c.widget._debugContextMenu = [
		[ i18n.getMessage("Open") + " sc_cat_item", function(){
			var item = c.data.sc_cat_item;
			$window.open("/sp_config?id=form&table=" + item.table + "&sys_id=" + item.sys_id); }]
	];
	c.showAddCartBtn = function() {
		return c.options.show_add_cart_button &&
			c.data.sc_cat_item.sys_class_name !== "sc_cat_item_producer" &&
			!c.data.sc_cat_item.no_cart && !c.data.is_cart_item;
	}
	
	c.showQuantitySelector = function() {
		return c.data.sc_cat_item.sys_class_name !== "sc_cat_item_producer" &&
			!c.data.sc_cat_item.no_quantity &&
			(!c.data.sc_cat_item.no_order_now || !c.data.sc_cat_item.no_cart);
	}

	c.showOrderNowButton = function() {
		return !$scope.data.is_cart_item && (c.data.sc_cat_item.use_sc_layout || !c.data.sc_cat_item.no_order_now);
	}

	c.allowOrder = function() {
		if (c.data.sc_cat_item.use_sc_layout)
			return true;

		if (c.data.sc_cat_item.no_order)
			return false;

		if (c.data.sc_cat_item.no_order_now && c.data.sc_cat_item.no_cart)
			return false;

		return true;
	}
	
	c.hideCartMsg = function () {
		$scope.data.showMsg = false;
	}

	$scope.$on('dialog.upload_too_large.show', function(e){
		$log.error($scope.m.largeAttachmentMsg);
		spUtil.addErrorMessage($scope.m.largeAttachmentMsg);
	});

	$scope.m = $scope.data.msgs;
	var ah = $scope.attachmentHandler = new nowAttachmentHandler(setAttachments, appendError);
	function appendError(error) {
		spUtil.addErrorMessage(error.msg + error.fileName);
	}
	ah.setParams($scope.data._attachmentTable, $scope.data._generatedItemGUID, 1024 * 1024 * $scope.data.maxAttachmentSize);
	function setAttachments(attachments, action) {
		$scope.attachments = attachments;
		if (action === "added")
			$scope.setFocusToAttachment();
		if (action === "renamed")
			spAriaUtil.sendLiveMessage($scope.m.renameSuccessMsg);
		if (action === "deleted")
			spAriaUtil.sendLiveMessage($scope.m.deleteSuccessMsg);
	}
	$scope.attachmentHandler.getAttachmentList();

	$scope.confirmDeleteAttachment = function(attachment, $event) {
    $rootScope.$broadcast("dialog.delete_attachment.show", {
      parms: {
        ok: function() {
          $scope.attachmentHandler.deleteAttachment(attachment);
          $rootScope.$broadcast("dialog.delete_attachment.close");
        },
        cancel: function() {
          $rootScope.$broadcast("dialog.delete_attachment.close");
        },
        details: attachment.name
      }
    })
  }

	$scope.dismissWishListMessage = function() {
		$scope.is_update_wishlist = false;
	}
	
  if ($scope.data.sc_cat_item) {
		$scope.data.sc_cat_item.description = $sce.trustAsHtml($scope.data.sc_cat_item.description);
		if (angular.equals($scope.data.sc_cat_item._fields, {}))
				$scope.data.no_fields = true;
		if ($scope.data.sc_cat_item.sys_class_name !== "sc_cat_item_producer")
			$scope.submitButtonMsg = $scope.m.orderNowMsg;
		else
			$scope.submitButtonMsg = $scope.m.submitMsg;
		
		// Breadcrumbs
		if (!$scope.data.categories)
		$scope.data.categories = [];
		if ($scope.data.is_wishlist_item) {
			$scope.data.categories.unshift({label: $scope.m.wishlistMsg, url: '?id=sc_wishlist'});
			$scope.data.categories.push({label: $scope.data.sc_cat_item.name, url: '#'});
		}
		else if ($scope.data.is_cart_item) {
			$scope.data.categories.unshift({label: $scope.m.cartMsg, url: '?id=sc_cart'});
			$scope.data.categories.push({label: $scope.data.sc_cat_item.name, url: '#'});
		}
		else {
			$scope.data.categories.unshift({label: $scope.data.sc_catalog || $scope.page.title, url: '?id=' + $scope.data.sc_catalog_page});
			$scope.data.categories.push({label: $scope.data.sc_cat_item.name, url: '#'});
		}
		$timeout(function() {
			$scope.$emit('sp.update.breadcrumbs', $scope.data.categories);
		});
		spUtil.setSearchPage('sc');
	} else {
		var notFoundBC = [{label: $scope.page.title, url: '?id=' + $scope.data.sc_catalog_page}];
		$timeout(function() {
			$scope.$emit('sp.update.breadcrumbs', notFoundBC);
		});
		spUtil.setSearchPage('sc');
	}

	var g_form;
	$scope.$on('spModel.gForm.initialized', function(e, gFormInstance){
		g_form = gFormInstance;

		// This runs after all onSubmit scripts have executed
		g_form.$private.events.on('submitted', function(){
			if ($scope.data.sc_cat_item.item_action === "order")
				getOne();
			else if ($scope.data.sc_cat_item.item_action === "add_to_cart")
				addToCart();
			else if ($scope.data.sc_cat_item.item_action == "update_cart")
				updateCart();
		});
	});

	function getVarData(fields) {
		var reqData = {};
		for(var obj in fields)
			reqData[fields[obj].variable_name] = fields[obj].value;
		return reqData;
	}

	function addLink(url, msg) {
		return " <a href=" + url + ">" + msg + "</a>";
	}
	
	$scope.$on("$sp.service_catalog.wishlist.update", function(evt, item) {
		if (item === $scope.data.sys_id)
			$scope.data.show_wishlist_msg = false;
	});

	$scope.addToWishlist = function() {
		$scope.submitting = true;
		$scope.m.actionMsg = $scope.data.is_wishlist_item ? $scope.m.wishlistUpdateMsg : $scope.m.wishlistAddMsg;
		$scope.m.actionMsg += addLink('?id=sc_wishlist', $scope.m.viewWishListMsg);
		$scope.m.actionMsg += '<i class="fa fa-close pull-right pointer" ng-click="c.hideCartMsg()"/>';
		$scope.m.actionMsg = $sce.trustAsHtml($scope.m.actionMsg);
		$scope.is_update_wishlist = false;
		spScUtil.addToWishlist($scope.data.sc_cat_item.sys_id, c.quantity, getVarData($scope.data.sc_cat_item._fields), $scope.data._generatedItemGUID).then(function(response){
			var cartItemId = "";
			for (var i=0; i<response.data.result.items.length; i++) {
				var item = response.data.result.items[i];
				if (item.catalog_item_id === $scope.data.sc_cat_item.sys_id) {
					cartItemId = item.cart_item_id;
					break;
				}
			}
			$rootScope.$broadcast("$sp.service_catalog.wishlist.add_item");
			$rootScope.$broadcast("$sp.service_catalog.wishlist.update", cartItemId);
			$scope.data.showMsg = $scope.is_update_wishlist = true;
			$scope.data.is_wishlist_item = true;
			$scope.data.show_wishlist_msg = false;
			$scope.submitting = false;
			spUtil.scrollTo('#sc_cat_item', 300);
		});
	}

	$scope.triggerAddToCart = function() {
		$scope.data.sc_cat_item.item_action = "add_to_cart";
		$scope.data.sc_cat_item.quantity = c.quantity;
		if (g_form)
			g_form.submit();
	}

	$scope.triggerUpdateCart = function() {
		$scope.data.sc_cat_item.item_action = "update_cart";
		$scope.data.sc_cat_item.quantity = c.quantity;
		if (g_form)
			g_form.submit();
	}

	$scope.triggerOnSubmit = function(){

		$scope.data.sc_cat_item.item_action = "order";
				$scope.data.sc_cat_item.quantity = c.quantity;
				if (g_form){
					g_form.submit();
		/*			
		if($scope.attachments.length == 0){
			alert("You must attach a PDF file to submit");
			return false;
		}
		else if($scope.attachments.length != 0){
			if($scope.attachments[0].ext != 'pdf'){
				alert("You must attach a PDF only.");
				return false;
			}	
			else if($scope.attachments.length > 1){
				alert("You can attach only 1 file.");
				return false;
			}
			else{			
				$scope.data.sc_cat_item.item_action = "order";
				$scope.data.sc_cat_item.quantity = c.quantity;
				if (g_form){
					g_form.submit();					 				
 					/*$timeout(function() {
						//$window.location.href="/scm/?id=scm_subconsultant_form&table=x_icir_scm_subconsultant&sys_id=" + $scope.invoiceSysID;						
 				   }, 1000, false);		*/	/*							
				}				
			}	
			*/
		}	
		
		
	}

	// order / create request
	function getOne() {
		$scope.server.get({
			action: 'log_request',
			itemDetails: {sys_id: $scope.data.sc_cat_item.sys_id, 
										name: $scope.data.sc_cat_item.name,
										sys_class_name: $scope.data.sc_cat_item.sys_class_name}
		});

		if ($scope.data.sys_properties.twostep && $scope.data.sc_cat_item.sys_class_name != "sc_cat_item_producer") {
			$scope.server.get({
				cart: 'cart_' + $scope.data.sc_cat_item.sys_id,
				itemDetails: {sys_id: $scope.data.sc_cat_item.sys_id, quantity: $scope.data.sc_cat_item.quantity, fields: getVarData($scope.data.sc_cat_item._fields), newRecordID: $scope.data._generatedItemGUID},
				action: $scope.data.is_wishlist_item ? "order_wishlist_item" : "order_item"
			}).then(function(response) {
				var orderItemModalCtrl;
				var unregister = $scope.$on('$sp.service_catalog.cart.place_order', function(){
					orderItemModalCtrl.close();
				});

				var orderItemModal = angular.copy(response.data.orderItemModal);
				orderItemModal.options.afterOpen = function(ctrl){
					orderItemModalCtrl = ctrl;
				};
				orderItemModal.options.afterClose = function() {
					unregister();
					c.orderItemModal = null;
					orderItemModalCtrl = null;
				};
				c.orderItemModal = orderItemModal;
			});
		} else {
			postCatalogFormRequest().then(function(response) {
				var a = response.data.result;
				
				
				$scope.$emit("$$uiNotification", a.$$uiNotification);
				$scope.$emit("$sp.sc_cat_item.submitted", a);
				if ($scope.data.is_wishlist_item)
					$rootScope.$broadcast("$sp.service_catalog.wishlist.update");
				if (a.number)
					handleRedirect(a.number, a.table, a.sys_id, a.redirect_to, a.redirect_portal_url);
				$scope.submitting = false;
				$scope.submitButtonMsg = $scope.m.submittedMsg;
			});
		}
	}

	function addToCart() {
		$scope.server.get({
			action: 'log_request',
			itemDetails: {sys_id: $scope.data.sc_cat_item.sys_id, 
										name: $scope.data.sc_cat_item.name,
										sys_class_name: $scope.data.sc_cat_item.sys_class_name}
		});
		
		postCatalogFormRequest().then(function(response) {
			$rootScope.$broadcast("$sp.service_catalog.cart.add_item");
			$rootScope.$broadcast("$sp.service_catalog.cart.update");
			$scope.$emit("$sp.sc_cat_item.add_to_cart");
			if ($scope.data.is_wishlist_item) {
				$rootScope.$broadcast("$sp.service_catalog.wishlist.update");
				$scope.data.is_wishlist_item = false;
			}
			c.status = i18n.getMessage("Added item to shopping cart");
			$scope.server.get({action: 'init_item'}).then(function(response) {
				$scope.data._generatedItemGUID = response.data._generatedItemGUID;
				ah.setParams($scope.data._attachmentTable, $scope.data._generatedItemGUID, 1024 * 1024 * $scope.data.maxAttachmentSize);
				$scope.attachmentHandler.getAttachmentList();
				$scope.m.actionMsg = $scope.m.cartAddMsg + addLink('?id=sc_cart', $scope.m.viewCartMsg);
				$scope.m.actionMsg += '<i class="fa fa-close pull-right pointer" ng-click="c.hideCartMsg()"/>';
				$scope.m.actionMsg = $sce.trustAsHtml($scope.m.actionMsg);
				$scope.data.showMsg = true;
				$scope.submitting = false;
				spUtil.scrollTo('#sc_cat_item', 300);
			});
		});
	}

	function updateCart() {
		postCatalogFormRequest().then(function(response) {
			c.status = i18n.getMessage("Updated Item to shopping cart.");
			$window.location.href = '?id=sc_cart';
		})
	}

	function postCatalogFormRequest() {
		$scope.submitting = true;
		if ($scope.data.is_wishlist_item) {
			$scope.is_update_wishlist = false;
			$scope.data.show_wishlist_msg = false;
			if ($scope.data.sc_cat_item.sys_class_name === "sc_cat_item_producer")
				return spScUtil.submitWishlistedProducer($scope.data.sc_cat_item.sys_id, getVarData($scope.data.sc_cat_item._fields), $scope.data._generatedItemGUID);
			else if ($scope.data.sc_cat_item.item_action === "order")
				return spScUtil.orderWishlistedItem($scope.data.sc_cat_item.sys_id, $scope.data.sc_cat_item.quantity, getVarData($scope.data.sc_cat_item._fields), $scope.data._generatedItemGUID);
			else if ($scope.data.sc_cat_item.item_action === "add_to_cart")
				return spScUtil.addWishlistedItemToCart($scope.data.sc_cat_item.sys_id, $scope.data.sc_cat_item.quantity, getVarData($scope.data.sc_cat_item._fields), $scope.data._generatedItemGUID);
		}
		else if ($scope.data.is_cart_item)
			return spScUtil.updateCart($scope.data._generatedItemGUID, $scope.data.sc_cat_item.quantity, getVarData($scope.data.sc_cat_item._fields));
		else if ($scope.data.sc_cat_item.sys_class_name === "sc_cat_item_producer")
			return spScUtil.submitProducer($scope.data.sc_cat_item.sys_id, getVarData($scope.data.sc_cat_item._fields), $scope.data._generatedItemGUID);
		else if ($scope.data.sc_cat_item.item_action === "order")
			return spScUtil.orderNow($scope.data.sc_cat_item.sys_id, $scope.data.sc_cat_item.quantity, getVarData($scope.data.sc_cat_item._fields), $scope.data._generatedItemGUID);
		else if ($scope.data.sc_cat_item.item_action === "add_to_cart")
			return spScUtil.addToCart($scope.data.sc_cat_item.sys_id, $scope.data.sc_cat_item.quantity, getVarData($scope.data.sc_cat_item._fields), $scope.data._generatedItemGUID);
	}

	// spModel populates mandatory - hasMandatory is called by the submit button
	$scope.hasMandatory = function() {
		return c.mandatory && c.mandatory.length > 0;
	};

	// switch catalog items
	var unregister = $scope.$on('$sp.list.click', onListClick);
	$scope.$on("$destroy", function() {
		$rootScope.$broadcast("$sp.service_catalog.item.close");
		unregister();
	});

	function onListClick(evt, arg) {
		$scope.data.sys_id = arg.sys_id;
		spUtil.update($scope);
	}

	function handleRedirect(n, table, sys_id, redirectTo, redirectUrl) {
		var page = table == 'sc_request' ? 'sc_request' : 'ticket';
		
		if (redirectTo == 'catalog_home') 
			page = 'sc_home';
		if (c.options.page) {page = c.options.page;}
		if (c.options.table) {table = c.options.table;}
		//AK : redirect to created invoice
		//$window.location.href="/vcm?id=vcm_invoice_form&table=x_icir_vcm_invoices&sys_id=" + sys_id;	
		
		var url = spUtil.format(c.options.url, {page: page, table: table, sys_id: sys_id});
		if ($scope.data.sc_cat_item.sys_class_name === "sc_cat_item_producer") {
// 			if (redirectUrl)
// 				$window.location.href = redirectUrl;
// 			else
// 				$window.location.href = url;
// 			return;
		}
		
		
		//$window.location.href = spUtil.format(c.options.url, {page: 'sc_request', table:'sc_request', sys_id: sys_id});
		return;
	}
    
    $timeout(function() {
        if ($document[0].getElementsByClassName('sc-sticky-item-header').length > 0) {
            var titleHeight = $document[0].getElementsByClassName('sc-sticky-item-header')[0].clientHeight;
            $scope.stickyHeaderTop = '-' + (titleHeight - 20 - $document[0].getElementsByClassName('sc-cat-item-short-description')[0].clientHeight) + 'px;';
        }
    });
}]]></client_script>
        <controller_as>c</controller_as>
        <css>.panel-button {
  float: none;
}
.wrapper-md {
  padding: 20px !important;
  background: #f9faf7;
}
label{
 	font-weight: bold !important;
  color:#5a5a5a;
}
.m-b-sm{
  font-weight: bold !important;
}
.sp-attachment-add {
  padding: 5px;
}

.p-t-none {
  padding-top: 0 !important;
}

.file-list-wrap {
	margin-bottom: 10px;
}

.sc-btn {
  color: $text-color;
}

.dismiss-button {
  position: absolute;
  top: 1rem;
	right: 10px;
	color: $text-color;
	cursor: pointer;
}

.item-header {
  padding-top: 10px !important;
  padding-bottom: 10px !important;
}

.sc-sticky-item-header {
  position: sticky;
  position: -webkit-sticky;
  position: -ms-sticky;
  top: -($font-size-h2 + $font-size-base);
  z-index: 10;
  background:url(lynx-record-producer-bg.jpg) no-repeat bottom right #9293b6;
  color:#161736;
  border-radius: 4px 4px 0 0;
  height:120px;
}
.m-b-sm{
 	font-weight:500; 
}
.text-muted{
 	color:#fff !important; 
}
.sc-fixed {
  position: fixed;
  max-height: 100%;
  width: 17.67777%;
}
.no-margin {
	margin: 0px; 
}
.sc-item-error-messages {
  max-height: 100%;
  position: absolute;
  overflow-y: auto;
  overflow-x: hidden;
  width: 100%; 
}
.sc-field-error-label {
  margin-right: .5em; 
  display: inline-block;
  cursor: pointer;
}
.image-gallery {
  font-size: 8px;
  color: #CECECE;
  .active {
    color: #717171;
  }
  i {
    padding: 0 5px;
  }
}
.relative {
  position: relative;
}
.sc-order-widget-btn {
   position: absolute;
   left: 9%;
   top: 10px
}
@media only screen and (max-width : 992px) {
  .sc-fixed {
    position: relative;
    width: 100%;
  }
  .wishlist-update-message {
    display : block;
  }
  .sc-item-error-messages {
    position: relative;
  }
  .read-more, .read-less {
    font-size: 15px;
    cursor: pointer;
  }
  .more-text {
    display: none;
  }
  .inline-cart {
    display: none;
  }
  .right-side-cart {
    display: inherit !important;
  }
}
@media only screen and (max-width : 768px) {
  .sc-sticky-item-header {
     position: inherit;
  }
  
}
.inline-cart {
  .quantity-selector {
    display: inline-block;
    width: 65px;
    padding-top: 2px;
  }
}

.add-on &gt; button.lookup {
  display:none;
}
.field-has-reference .reference {
       display: block;
}</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list>color</field_list>
        <has_preview>true</has_preview>
        <id/>
        <internal>false</internal>
        <link><![CDATA[function(scope, elem){
    scope.setFocusToAttachment = function () {
		setTimeout(function () {
			var inboxArray = elem.find("a.view-attachment");
			inboxArray.focus();
		}, 100);
	}
}
]]></link>
        <name>VCM Invoice SC Catalog Item</name>
        <option_schema>[{"name":"show_add_cart_button","label":"Show Add Cart Button","type":"boolean"},{"hint":"If you turn on this, you will be able to see field validation messages on right side","name":"show_field_validation_messages","default_value":"true","label":"Show field validation messages","type":"boolean"},{"hint":"Show Add/Update Wish List buttons","name":"show_add_to_wishlist_button","default_value":"true","label":"Show Add/Update Wish List buttons","type":"boolean"},{"hint":"Order item section on top. If you uncheck this, order section will be displayed at bottom of screen","name":"display_cart_on_right","default_value":"true","label":"Order Item Section On Top","type":"boolean"},{"hint":"Show item description in few words with an option to read more","name":"show_less_description","default_value":"true","label":"Enable Show More/Less for Item description on Mobile","type":"boolean"}]</option_schema>
        <public>false</public>
        <roles/>
        <script><![CDATA[// populate the 'data' variable with catalog item, variables, and variable view
(function() {
	if (input && input.action == 'init_item') {
		data._generatedItemGUID = gs.generateGUID();
		return;
	}
	else if (input && input.action === "order_item") {
		data.orderItemModal = $sp.getWidget('widget-modal', {embeddedWidgetId: 'sc-checkout', embeddedWidgetOptions: {cart: {name: input.cart}, action: 'order_now', item: input.itemDetails, requested_for: {id:options.requested_for_id, displayValue:options.requested_for_display}
																																																								 }, backdrop: 'static', keyboard: false, size: 'md'});
		return;
	} else if (input && input.action == "order_wishlist_item") {
		data.orderItemModal = $sp.getWidget('widget-modal', {embeddedWidgetId: 'sc-checkout', embeddedWidgetOptions: {cart: {name: input.cart}, action: 'order_now_wishlisted_item', item: input.itemDetails, requested_for: {id:options.requested_for_id, displayValue:options.requested_for_display}
																																																								 }, backdrop: 'static', keyboard: false, size: 'md'});
		return;
	} else if (input && input.action === 'log_request') {
		 $sp.logStat('Cat Item Request', input.itemDetails.sys_class_name, input.itemDetails.sys_id, input.itemDetails.name);
		 return;
	}
	
	// portal can specify a catalog and catalog category home page
	data.sc_catalog_page = $sp.getDisplayValue("sc_catalog_page") || "sc_home";
	data.sc_category_page = $sp.getDisplayValue("sc_category_page") || "sc_category";
	data.sc_catalog = $sp.getDisplayValue('sc_catalog');
	var edit_parm = $sp.getParameter('edit');
	data.is_cart_item = edit_parm == 'cart';
	data.is_wishlist_item = edit_parm == 'wishlist';
	data.show_wishlist_msg = false;
	data.recordFound = true;

	options.show_add_cart_button = (options.show_add_cart_button == "true");

	if (options.page) {
		var pageGR = new GlideRecord("sp_page");
		options.page = (pageGR.get(options.page)) ? pageGR.getValue("id") : null;
	}

	if (options.table) {
		var tableGR = new GlideRecord("sys_db_object");
		options.table = (tableGR.get(options.table)) ? tableGR.getValue("name") : null;
	}

	options.url = options.url || "?id={page}&is_new_order=true&table={table}&sys_id={sys_id}";
	data.showPrices = $sp.showCatalogPrices();
	var m = data.msgs = {};
	m.submitMsg = gs.getMessage("Submit");
	m.orderNowMsg = gs.getMessage("Order Now");
	m.submittedMsg = gs.getMessage("Submitted");
	m.createdMsg = gs.getMessage("Created");
	m.trackMsg = gs.getMessage("track using 'Requests' in the header or");
	m.clickMsg = gs.getMessage("click here to view");
	m.dialogTitle = gs.getMessage("Delete Attachment");
	m.dialogMessage = gs.getMessage("Are you sure?");
	m.dialogOK = gs.getMessage("OK");
	m.dialogCancel = gs.getMessage("Cancel");
	
	m.renameSuccessMsg = gs.getMessage("Attachment renamed successfully");
	m.deleteSuccessMsg = gs.getMessage("Attachment deleted successfully");
	m.wishlistMsg = gs.getMessage('Wish List');
	m.cartMsg = gs.getMessage('Cart');
	m.itemWishlistMsg = gs.getMessage('This item is already in your Wish List. If you attempt to add this item to your Wish List it will overwrite the existing item.');
	m.invalidRecordMsg = gs.getMessage('You are either not authorized or record is not valid.');
	m.wishlistUpdateMsg = gs.getMessage('Your Wish List has been updated.');
	m.wishlistAddMsg = gs.getMessage('Your item has been added to your Wish List.');
	m.cartAddMsg = gs.getMessage('Your item has been added to your Cart. To make changes to the items in your cart, click ');
	m.viewWishListMsg = gs.getMessage('View Wish List');
	m.viewCartMsg = gs.getMessage('View Cart');

	data.maxAttachmentSize = parseInt(gs.getProperty("com.glide.attachment.max_size", 1024));
	if (isNaN(data.maxAttachmentSize))
		data.maxAttachmentSize = 24;
	m.largeAttachmentMsg = gs.getMessage("Attached files must be smaller than {0} - please try again", "" + data.maxAttachmentSize + "MB");
	
	var cartName = data.is_cart_item ? 'DEFAULT' : 'saved_items';
	var cart = new sn_sc.CartJS(cartName);

	data.showWishlist = new sn_sc.Catalog('' + $sp.getValue('sc_catalog')).isWishlistEnabled();
	
	if (edit_parm) {
		var cart_item_id = $sp.getParameter("sys_id");
		var gr = new GlideRecord("sc_cart_item");
		if (!gr.get(cart_item_id) || gr.cart != cart.getCartID()) {
			data.recordFound = false;
			return;
		}
		var catItemData = {};
		catItemData.sys_id = gr.getValue('cat_item');
		catItemData.cart_item_id = gr.getUniqueValue();
		catItemData.table = "sc_cart_item";
		catItemData.is_ordering = !!options.isOrdering;

		data.sc_cat_item = $sp.getCatalogItem(catItemData);
		data.sc_cat_item.isCartItem = true;
		var values = getValues(cart_item_id);

		for(var f in data.sc_cat_item._fields) {
			// Put the values into the cat item fields
			var field = data.sc_cat_item._fields[f];
			if (typeof values[f] != "undefined" && typeof values[f].value != "undefined") {
				if (values[f].type == 9 || values[f].type == 10)
					field.value = values[f].displayValue;
				else
					field.value = values[f].value;
				field.displayValue = values[f].displayValue;
				field.display_value_list = values[f].display_value_list;
			}
			updatePriceOnField(field);
				
		}
		data._generatedItemGUID = cart_item_id;
		data.quantity = '' + gr.quantity;
	} else {
	
		if (input)
			data.sys_id = input.sys_id;
		else if (options.sys_id)
			data.sys_id = options.sys_id;
		else
			data.sys_id = $sp.getParameter("sys_id") || $sp.getParameter('sl_sys_id');
	
		if (!data.sys_id) {
			data.recordFound = false;
			return;
		}
	
		data._generatedItemGUID = gs.generateGUID();
		var validatedItem = new sn_sc.CatItem('' + data.sys_id);
		if (!validatedItem.canView() || !validatedItem.isVisibleServicePortal()) {
			data.recordFound = false;
			return;
		}
	
		data.sc_cat_item = $sp.getCatalogItem(data.sys_id, true);
		if (data.sc_cat_item.category) {
			var categoryJS;
			var categoryID = data.sc_cat_item.category;
			if ($sp.getParameter("sysparm_category")) {
				categoryJS = new sn_sc.CatCategory($sp.getParameter("sysparm_category") + "");
				categoryID = $sp.getParameter("sysparm_category") + "";
			}
			else {
				categoryJS = new sn_sc.CatCategory(data.sc_cat_item.category);
			}
			data.category = {
				name: categoryJS.getTitle(),
				url: categoryJS.canView() ? '?id=' + data.sc_category_page + '&sys_id=' + categoryID : "#"
			}
			data.categories = [];
			data.categories.push({
				label: categoryJS.getTitle(),
				url: categoryJS.canView() ? '?id=' + data.sc_category_page + '&sys_id=' + categoryID : "#"
			});
			while(categoryJS && categoryJS.getParent()) {
				var parentId =  categoryJS.getParent();
				categoryJS = new sn_sc.CatCategory(parentId);
				var category = {
					label: categoryJS.getTitle(),
					url: categoryJS.canView() ? '?id=' + data.sc_category_page + '&sys_id=' + parentId : "#"
				};
				data.categories.unshift(category);
			}
		}
		var gr = new GlideRecord('sc_cart_item');
		gr.addQuery('cart', cart.getCartID());
		gr.addQuery('cat_item', data.sys_id);
		gr.query();
		if (gr.next())
			data.show_wishlist_msg = true;
	}

	data.sys_properties = {
		twostep: gs.getProperty("glide.sc.sp.twostep", "true") == 'true'
	};

	var athTblName = 'sc_cart_item';
	var className = data.sc_cat_item.sys_class_name;
	if (!new global.CatalogItemTypeProcessor().canCreateNormalCartItem(className)) {
		if (className == 'sc_cat_item_producer') {
				var gr = new GlideRecord('sc_cat_item_producer');
				gr.get(data.sc_cat_item.sys_id);
				if (gr.isValidRecord())
					athTblName = gr.getValue('table_name');
		}
	}
	data._attachmentTable = athTblName;

	$sp.logStat('Cat Item View', data.sc_cat_item.sys_class_name, data.sc_cat_item.sys_id, data.sc_cat_item.name);
	
	function getValues(sys_id) {
		var qs = new sn_sc.VariablePoolQuestionSetJS();
		qs.setCartID(sys_id);
		qs.load();
		var values = {};
		var questions = qs.getFlatQuestions();
		for (var i = 0; i < questions.length; i++)
			values["IO:" + questions[i].sys_id] = questions[i];
		return values;
	}

	function setPrice(field, p, rp) {
		if (p != undefined)
			field.price = p;
		if (rp != undefined)
			field.recurring_price = rp;
	}

	function updatePriceForReferenceTable(field) {
		var tableName = field.refTable + '';
		if (tableName != undefined && tableName != null && tableName != '') {
			var gr = new GlideRecord(tableName);
			if (gr.isValid()) {
				if (gr.get(field.value) && gr.isValidRecord()) {
					updatePrice(gr, field);
					updateRecurringPrice(gr, field);
				}
			}
		}
	}

	function updatePriceForListCollector(field) {
		var tableName = field.refTable + '';
		if (tableName != undefined && tableName != null && tableName != '') {
			var gr = new GlideRecord(tableName);
			if (gr.isValid()) {
				var values = field.value.split(',');
				gr.addQuery('sys_id', values);
				gr.query();
				var p = 0.0;
				var rp = 0.0;
				var price_value_list = [];
				while(gr.next()) {
						var price_field = {};
						updatePrice(gr, price_field);
						updateRecurringPrice(gr, price_field);
						if (price_field.price)
							p += Number(price_field.price);
						else
							price_field.price = 0.0;
						if (price_field.recurring_price)
							rp += Number(price_field.recurring_price);
						else
							price_field.recurring_price = 0.0;
						price_value_list.push(price_field);
				}
				field.price = p;
				field.recurring_price = rp;
				field.price_value_list = price_value_list;
			}
		}
	}

	function updatePrice(gr, field) {
		if (gr.isValidField('price'))
			field.price = gr.getValue('price');
		else if (gr.isValidField('u_price'))
			field.price = gr.getValue('u_price');
	}

	function updateRecurringPrice(gr, field) {
		if (gr.isValidField('recurring_price'))
			field.recurring_price = gr.getValue('recurring_price');
		else if (gr.isValidField('u_recurring_price'))
			field.recurring_price = gr.getValue('u_recurring_price');
	}

	function updatePriceOnField(field) {
		if (field.type == 'boolean' || field.type == 'boolean_confirm') {
			if (field.value == 'true' || field.value == true)
				setPrice(field, field._pricing.price_if_checked, field._pricing.recurring_price_if_checked);
			else
				setPrice(field, 0, 0);
		} else if (field.choices) {
			field.choices.forEach( function(choice) {
				if (choice.value +'' == field.value + '')
					 setPrice(field, choice.price, choice.recurring_price);
			});
		} else if (field._pricing && field._pricing.pricing_implications === true) {
			if (field.type == 'reference') 
				updatePriceForReferenceTable(field);
			else if (field.type == 'glide_list')
				updatePriceForListCollector(field);
		}
	}
})()
]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>Anagha.Kunjeer@infocenter.io</sys_created_by>
        <sys_created_on>2019-02-07 02:17:23</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_id>eac7f654db6b2f00ccd6f2f5ab9619da</sys_id>
        <sys_mod_count>12</sys_mod_count>
        <sys_name>VCM Invoice SC Catalog Item</sys_name>
        <sys_package display_value="Vendor Contract Management" source="x_icir_vcm">3fe81872db2caf40c203a2364b9619e0</sys_package>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="Vendor Contract Management">3fe81872db2caf40c203a2364b9619e0</sys_scope>
        <sys_update_name>sp_widget_eac7f654db6b2f00ccd6f2f5ab9619da</sys_update_name>
        <sys_updated_by>Anagha.Kunjeer@infocenter.io</sys_updated_by>
        <sys_updated_on>2019-02-07 05:40:45</sys_updated_on>
        <template><![CDATA[<div id="sc_cat_item" ng-if="::data.recordFound">
  <sp-widget widget="c.orderItemModal" ng-if="c.orderItemModal"></sp-widget>
  <div class="row" ng-if="::data.sc_cat_item" >
    <div class="col-sm-12" ng-class="{true: 'col-md-9', false: 'col-md-12'}[options.display_cart_on_right === 'true']" id="catItemTop">
      <!-- Info Message Box -->
      <div ng-if="data.show_wishlist_msg" class="alert alert-info">
        	{{::m.itemWishlistMsg}}
      </div>
      <!--	Success Message Box	-->
      <div class="alert alert-success" ng-if="data.showMsg" sc-bind-html-compile="m.actionMsg">
      </div>
     <div class="panel panel-default">
        <!-- Title Section -->
        <div class="wrapper-md b-b break-word item-header" ng-class="{true: '', false: 'sc-sticky-item-header'}[!c.data.sc_cat_item.short_description]" style="top: {{stickyHeaderTop}}">
        	<!--<h1 class="h2 m-t-none m-b-sm font-thin" ng-if="::data.sc_cat_item.name">{{::data.sc_cat_item.name}}</h1>-->
          <h1 class="h2 m-t-none m-b-sm font-thin" ng-if="::data.sc_cat_item.name">Invoice</h1>
        	<!--<div class="text-muted sc-cat-item-short-description" ng-if="::data.sc_cat_item.short_description">{{::data.sc_cat_item.short_description}}</div>-->
      	</div>
        <div class="wrapper-md row b-b no-margin" ng-if="c.data.sc_cat_item.picture || c.data.sc_cat_item.description">
          <div class="col-sm-4 col-xs-12 no-padder" ng-if="c.data.sc_cat_item.picture">
            <div class="wrapper-md text-center">
              <i class="fa fa-chevron-left pointer" style="position:absolute; top:50%; left:4%; color:#CECECE" ng-if="options.image_gallery"></i>
              <img class="img-responsive catalog-item-image" alt="{{::data.sc_cat_item.name}}" style="display: inline" ng-src="{{::data.sc_cat_item.picture}}?t=medium" />
              <i class="fa fa-chevron-right pointer" style="position:absolute; top:50%; right:4%; color:#CECECE" ng-if="options.image_gallery"></i>
              <div class="image-gallery padding-top" ng-if="options.image_gallery">
                <i class="fa fa-circle active"></i>
                <i class="fa fa-circle"></i>
                <i class="fa fa-circle"></i>
              </div>
            </div>
          </div>
          <div class="col-xs-12 padder-md break-word"
               ng-class="{true: 'col-sm-12 no-padder', false: 'col-sm-8'}[!c.data.sc_cat_item.picture]">
            <div class="visible-md visible-lg" ng-class="{false : 'visible-xs visible-sm', true : 'hidden-xs hidden-sm'}[c.options.show_less_description === 'true']">
              <div ng-bind-html="::data.sc_cat_item.description"></div>
            </div>
            <div class="col-xs-12 col-sm-12 visible-xs visible-sm" ng-if="c.options.show_less_description === 'true'">
              <sc-toggle-data sn-data="::data.sc_cat_item.description"></sc-toggle-data>
        		</div>
          </div>
        </div>
        <div class="" ng-class="{'b-b wrapper-md': !data.no_fields}">
          <sp-cat-item item="::data.sc_cat_item" ></sp-cat-item>
          <form>
            <!-- display view and model -->
            <sp-model form-model="::data.sc_cat_item" mandatory="c.mandatory"></sp-model>
          </form>
        </div>
        <!-- Bottom cart -->
        <div class="inline-cart" ng-if="::options.display_cart_on_right !== 'true'">
          <div ng-if="data.sc_cat_item.sys_class_name != 'sc_cat_item_content'" class="wrapper-md b-b">
              <div class="m-b text-right" ng-if="data.showPrices && (data.sc_cat_item.price || data.sc_cat_item.recurring_price)" >
               <b>${Price}:</b> {{data.sc_cat_item.price}}<em ng-if="data.sc_cat_item.recurring_price" class="cat_item_price"> + {{data.sc_cat_item.recurring_price}}</em>
              </div>
              <div ng-if="::c.allowOrder()" class="text-right">
                <select ng-if="c.showQuantitySelector()"
                        ng-disabled="submitting"
                        class="form-control quantity-selector m-r-xs"
                        ng-model="c.quantity"
                        aria-label="${Quantity}"
                        ng-options="num for num in [1,2,3,4,5,6,7,8,9,10]">
                </select>
                <button tabindex="0" ng-if="c.showAddCartBtn()" name="add_to_cart" ng-disabled="submitting" ng-click="triggerAddToCart()" class="btn btn-default m-r-xs">
                  <i class="fa fa fa-shopping-cart m-r-xs"></i>
                  ${Add to Cart}
                </button>
                <button tabindex="0" ng-if="data.is_cart_item" name="update" ng-disabled="submitting" ng-click="triggerUpdateCart()" class="btn btn-default">
                  <i class="fa fa fa-shopping-cart m-r-xs"></i>
                  ${Update Cart}
                </button>
                <span class="form-group relative" ng-if="data.showWishlist && !data.is_cart_item && c.options.show_add_to_wishlist_button === 'true'">
                  <button ng-if="!data.is_wishlist_item" name="add_to_wishlist" ng-click="addToWishlist()" ng-disabled="submitting" class="btn btn-default m-r-xs">
                    <i class="icon icon-sp-wishlist m-r-xs" style="vertical-align: text-bottom;"></i>
                    ${Add to Wish List}
                  </button>
                  <button ng-if="data.is_wishlist_item" name="update_wishlist" ng-click="addToWishlist()" ng-disabled="submitting" class="btn btn-default m-r-xs">
                    <i class="icon icon-sp-wishlist m-r-xs" style="vertical-align: text-bottom;"></i>
                    ${Update Wish List}
                  </button>
                </span>
								<button ng-if="::c.showOrderNowButton()" tabindex="0" name="submit" ng-disabled="submitting" ng-click="triggerOnSubmit()" class="btn btn-primary">{{::submitButtonMsg}}</button>
                <span ng-if="submitting" style="padding-left:4px">${Submitting...}</span>
              </div>
              <div ng-show="hasMandatory(c.mandatory)" class="alert alert-info" style="margin-top: .5em" ng-if="c.options.show_field_validation_messages === 'true'">
                <span ng-if="hasMandatory(mandatory)">${Required information} </span>
                <label ng-repeat="f in c.mandatory" for="sp_formfield_{{::f.catalogFieldName}}" class="label label-danger sc-field-error-label" style="margin-right: .5em; display: inline-block;">{{::f.label}}</label>
              </div>
            </div>
        </div>
        <div class="wrapper-md row no-margin">
          <now-attachments-list template="sp_attachment_single_line" ></now-attachments-list>
          <label ng-if="!submitting" style="float:right;font-weight:normal;cursor:pointer;">
            <sp-attachment-button></sp-attachment-button>
            <span style="padding-left:4px;">${Add attachments}</span>
          </label>
          
        </div>
      </div>
      <div ng-if="::data.sc_cat_item.content_type == 'external'" class="wrapper-md">
        <a ng-href="{{::data.sc_cat_item.url}}" target={{::data.sc_cat_item.target}}>{{::data.sc_cat_item.url}} ➚</a>
      </div>
			<div ng-if="::data.sc_cat_item.content_type == 'kb'" class="wrapper-md">
        <a  ng-href="?id=kb_article&sys_id={{::data.sc_cat_item.kb_article}}">${Go to KB Article:} {{::data.sc_cat_item.kb_article_description}}</a>
      </div>
    </div>
    <!-- Right side content -->
    <div class="col-sm-12 col-md-3 right-side-cart" ng-show="::options.display_cart_on_right === 'true'">
      <!-- Right side cart( If you are chaning anything here, please change in bottom cart section also) -->
      <div ng-class="{true:'sc-fixed', false:'' }[options.display_cart_on_right === 'true']">
      	<div ng-if="data.sc_cat_item.sys_class_name != 'sc_cat_item_content'" class="panel panel-{{::options.color}} b wrapper-md">
           <div class="form-group" ng-if="::c.allowOrder()">
             <select ng-if="c.showQuantitySelector()"
                     style="text-indent: 6px;"
                     ng-disabled="submitting"
                     class="form-control"
                     ng-model="c.quantity"
                     aria-label="${Quantity}"
                     ng-options="num for num in [1,2,3,4,5,6,7,8,9,10]">
             </select>
           </div>
           <div class="form-group relative">
             <button tabindex="0" ng-if="c.showAddCartBtn()" name="add_to_cart" ng-disabled="submitting" ng-click="triggerAddToCart()" class="btn btn-default sc-btn form-control">
               <i class="fa fa fa-shopping-cart sc-order-widget-btn pull-left"></i>
               ${Add to Cart}
             </button>
             <button tabindex="0" ng-if="data.is_cart_item" name="update" ng-disabled="submitting" ng-click="triggerUpdateCart()" class="btn btn-default sc-btn form-control">
               <i class="fa fa fa-shopping-cart sc-order-widget-btn pull-left"></i>
               ${Update Cart}
             </button>
           </div>
           <div class="form-group relative" ng-if="data.showWishlist && !data.is_cart_item && c.options.show_add_to_wishlist_button === 'true'">
             <button ng-if="!data.is_wishlist_item" name="add_to_wishlist" ng-click="addToWishlist()" ng-disabled="submitting" class="btn btn-default sc-btn form-control">
               <i class="icon icon-sp-wishlist sc-order-widget-btn pull-left" style="top:5px"></i>
               ${Add to Wish List}
             </button>
             <button ng-if="data.is_wishlist_item" name="update_wishlist" ng-click="addToWishlist()" ng-disabled="submitting" class="btn btn-default sc-btn form-control">
             	<i class="icon icon-sp-wishlist sc-order-widget-btn pull-left" style="top:5px"></i>
             	${Update Wish List}
             </button>
           </div>
           <div class="form-group" ng-if="data.showPrices && data.sc_cat_item.price">
             <b>${Price}:</b> {{data.sc_cat_item.price}}<em ng-if="data.sc_cat_item.recurring_price" class="cat_item_price"> + {{data.sc_cat_item.recurring_price}}</em>
           </div>
           <div class="form-group">
             <button ng-if="::c.showOrderNowButton()" tabindex="0" name="submit" ng-disabled="submitting" ng-click="triggerOnSubmit()" class="btn btn-primary btn-block">{{::submitButtonMsg}}</button>
             <span ng-if="submitting" style="padding-left:4px">${Submitting...}</span>
           </div>
         </div>
      	<div class="sc-item-error-messages" ng-if="c.options.show_field_validation_messages === 'true'">
            <div class="row" ng-if="hasMandatory(c.mandatory)" class=" row alert alert-info" style="margin-top: .5em">
              <div class="col-sm-12">
                <div ng-if="hasMandatory(c.mandatory)">${Required information} </div>
                <label ng-repeat="f in c.mandatory" for="sp_formfield_{{::f.catalogFieldName}}" class="label label-danger sc-field-error-label">{{::f.label}}</label>
              </div>
           </div>
         </div>
      </div>
    </div>
  </div>
  <sp-message-dialog name="delete_attachment"
                       title="{{::m.dialogTitle}}"
                       message="{{::m.dialogMessage}}"
                       ok="{{::m.dialogOK}}"
                       cancel="{{::m.dialogCancel}}"
                       dialog-class="delete-dialog"></sp-message-dialog>
  <div ng-if="::!data.sc_cat_item" >
    <div class="panel panel-default">
      <div class="panel-heading"><h4 class="panel-title">${Item not found}</h4></div>
      <div class="panel-body wrapper">
        <p>${This item is not found or currently not available}</p>
        <p>${Suggestions}:</p>
        <ul>
          <li>${Try searching for the item}</li>
          <li>${Go to the Service Catalog homepage}</li>
        </ul>
      </div>
    </div>
  </div>
  <div class="sr-only" aria-live="assertive">{{::c.status}}</div>
</div>
<div ng-if="::!data.recordFound" class="alert alert-info">{{::m.invalidRecordMsg}}</div>
<now-message key="Added item to shopping cart" value="${Added item to shopping cart}"/>
]]></template>
    </sp_widget>
    <sys_update_version action="INSERT_OR_UPDATE">
        <action>DELETE</action>
        <application display_value="Vendor Contract Management">3fe81872db2caf40c203a2364b9619e0</application>
        <file_path/>
        <instance_id>978e28dadba5cf4060a6f0e5bf9619ae</instance_id>
        <instance_name>ven02229</instance_name>
        <name>sp_widget_eac7f654db6b2f00ccd6f2f5ab9619da</name>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sp_widget"&gt;&lt;sp_widget action="INSERT_OR_UPDATE"&gt;&lt;category&gt;custom&lt;/category&gt;&lt;client_script&gt;&lt;![CDATA[function ($scope, $http, spScUtil, spUtil, nowAttachmentHandler, $rootScope, $sanitize, $window, $sce, i18n, $timeout, $log, spAriaUtil, $document, spModal) {
	var c = this;
	c.quantity = c.data.quantity ? parseInt(c.data.quantity) : 1;
	c.mandatory = [];
	$scope.stickyHeaderTop = '0px';

	c.widget._debugContextMenu = [
		[ i18n.getMessage("Open") + " sc_cat_item", function(){
			var item = c.data.sc_cat_item;
			$window.open("/sp_config?id=form&amp;table=" + item.table + "&amp;sys_id=" + item.sys_id); }]
	];
	c.showAddCartBtn = function() {
		return c.options.show_add_cart_button &amp;&amp;
			c.data.sc_cat_item.sys_class_name !== "sc_cat_item_producer" &amp;&amp;
			!c.data.sc_cat_item.no_cart &amp;&amp; !c.data.is_cart_item;
	}
	
	c.showQuantitySelector = function() {
		return c.data.sc_cat_item.sys_class_name !== "sc_cat_item_producer" &amp;&amp;
			!c.data.sc_cat_item.no_quantity &amp;&amp;
			(!c.data.sc_cat_item.no_order_now || !c.data.sc_cat_item.no_cart);
	}

	c.showOrderNowButton = function() {
		return !$scope.data.is_cart_item &amp;&amp; (c.data.sc_cat_item.use_sc_layout || !c.data.sc_cat_item.no_order_now);
	}

	c.allowOrder = function() {
		if (c.data.sc_cat_item.use_sc_layout)
			return true;

		if (c.data.sc_cat_item.no_order)
			return false;

		if (c.data.sc_cat_item.no_order_now &amp;&amp; c.data.sc_cat_item.no_cart)
			return false;

		return true;
	}
	
	c.hideCartMsg = function () {
		$scope.data.showMsg = false;
	}

	$scope.$on('dialog.upload_too_large.show', function(e){
		$log.error($scope.m.largeAttachmentMsg);
		spUtil.addErrorMessage($scope.m.largeAttachmentMsg);
	});

	$scope.m = $scope.data.msgs;
	var ah = $scope.attachmentHandler = new nowAttachmentHandler(setAttachments, appendError);
	function appendError(error) {
		spUtil.addErrorMessage(error.msg + error.fileName);
	}
	ah.setParams($scope.data._attachmentTable, $scope.data._generatedItemGUID, 1024 * 1024 * $scope.data.maxAttachmentSize);
	function setAttachments(attachments, action) {
		$scope.attachments = attachments;
		if (action === "added")
			$scope.setFocusToAttachment();
		if (action === "renamed")
			spAriaUtil.sendLiveMessage($scope.m.renameSuccessMsg);
		if (action === "deleted")
			spAriaUtil.sendLiveMessage($scope.m.deleteSuccessMsg);
	}
	$scope.attachmentHandler.getAttachmentList();

	$scope.confirmDeleteAttachment = function(attachment, $event) {
    $rootScope.$broadcast("dialog.delete_attachment.show", {
      parms: {
        ok: function() {
          $scope.attachmentHandler.deleteAttachment(attachment);
          $rootScope.$broadcast("dialog.delete_attachment.close");
        },
        cancel: function() {
          $rootScope.$broadcast("dialog.delete_attachment.close");
        },
        details: attachment.name
      }
    })
  }

	$scope.dismissWishListMessage = function() {
		$scope.is_update_wishlist = false;
	}
	
  if ($scope.data.sc_cat_item) {
		$scope.data.sc_cat_item.description = $sce.trustAsHtml($scope.data.sc_cat_item.description);
		if (angular.equals($scope.data.sc_cat_item._fields, {}))
				$scope.data.no_fields = true;
		if ($scope.data.sc_cat_item.sys_class_name !== "sc_cat_item_producer")
			$scope.submitButtonMsg = $scope.m.orderNowMsg;
		else
			$scope.submitButtonMsg = $scope.m.submitMsg;
		
		// Breadcrumbs
		if (!$scope.data.categories)
		$scope.data.categories = [];
		if ($scope.data.is_wishlist_item) {
			$scope.data.categories.unshift({label: $scope.m.wishlistMsg, url: '?id=sc_wishlist'});
			$scope.data.categories.push({label: $scope.data.sc_cat_item.name, url: '#'});
		}
		else if ($scope.data.is_cart_item) {
			$scope.data.categories.unshift({label: $scope.m.cartMsg, url: '?id=sc_cart'});
			$scope.data.categories.push({label: $scope.data.sc_cat_item.name, url: '#'});
		}
		else {
			$scope.data.categories.unshift({label: $scope.data.sc_catalog || $scope.page.title, url: '?id=' + $scope.data.sc_catalog_page});
			$scope.data.categories.push({label: $scope.data.sc_cat_item.name, url: '#'});
		}
		$timeout(function() {
			$scope.$emit('sp.update.breadcrumbs', $scope.data.categories);
		});
		spUtil.setSearchPage('sc');
	} else {
		var notFoundBC = [{label: $scope.page.title, url: '?id=' + $scope.data.sc_catalog_page}];
		$timeout(function() {
			$scope.$emit('sp.update.breadcrumbs', notFoundBC);
		});
		spUtil.setSearchPage('sc');
	}

	var g_form;
	$scope.$on('spModel.gForm.initialized', function(e, gFormInstance){
		g_form = gFormInstance;

		// This runs after all onSubmit scripts have executed
		g_form.$private.events.on('submitted', function(){
			if ($scope.data.sc_cat_item.item_action === "order")
				getOne();
			else if ($scope.data.sc_cat_item.item_action === "add_to_cart")
				addToCart();
			else if ($scope.data.sc_cat_item.item_action == "update_cart")
				updateCart();
		});
	});

	function getVarData(fields) {
		var reqData = {};
		for(var obj in fields)
			reqData[fields[obj].variable_name] = fields[obj].value;
		return reqData;
	}

	function addLink(url, msg) {
		return " &lt;a href=" + url + "&gt;" + msg + "&lt;/a&gt;";
	}
	
	$scope.$on("$sp.service_catalog.wishlist.update", function(evt, item) {
		if (item === $scope.data.sys_id)
			$scope.data.show_wishlist_msg = false;
	});

	$scope.addToWishlist = function() {
		$scope.submitting = true;
		$scope.m.actionMsg = $scope.data.is_wishlist_item ? $scope.m.wishlistUpdateMsg : $scope.m.wishlistAddMsg;
		$scope.m.actionMsg += addLink('?id=sc_wishlist', $scope.m.viewWishListMsg);
		$scope.m.actionMsg += '&lt;i class="fa fa-close pull-right pointer" ng-click="c.hideCartMsg()"/&gt;';
		$scope.m.actionMsg = $sce.trustAsHtml($scope.m.actionMsg);
		$scope.is_update_wishlist = false;
		spScUtil.addToWishlist($scope.data.sc_cat_item.sys_id, c.quantity, getVarData($scope.data.sc_cat_item._fields), $scope.data._generatedItemGUID).then(function(response){
			var cartItemId = "";
			for (var i=0; i&lt;response.data.result.items.length; i++) {
				var item = response.data.result.items[i];
				if (item.catalog_item_id === $scope.data.sc_cat_item.sys_id) {
					cartItemId = item.cart_item_id;
					break;
				}
			}
			$rootScope.$broadcast("$sp.service_catalog.wishlist.add_item");
			$rootScope.$broadcast("$sp.service_catalog.wishlist.update", cartItemId);
			$scope.data.showMsg = $scope.is_update_wishlist = true;
			$scope.data.is_wishlist_item = true;
			$scope.data.show_wishlist_msg = false;
			$scope.submitting = false;
			spUtil.scrollTo('#sc_cat_item', 300);
		});
	}

	$scope.triggerAddToCart = function() {
		$scope.data.sc_cat_item.item_action = "add_to_cart";
		$scope.data.sc_cat_item.quantity = c.quantity;
		if (g_form)
			g_form.submit();
	}

	$scope.triggerUpdateCart = function() {
		$scope.data.sc_cat_item.item_action = "update_cart";
		$scope.data.sc_cat_item.quantity = c.quantity;
		if (g_form)
			g_form.submit();
	}

	$scope.triggerOnSubmit = function(){

		$scope.data.sc_cat_item.item_action = "order";
				$scope.data.sc_cat_item.quantity = c.quantity;
				if (g_form){
					g_form.submit();
		/*			
		if($scope.attachments.length == 0){
			alert("You must attach a PDF file to submit");
			return false;
		}
		else if($scope.attachments.length != 0){
			if($scope.attachments[0].ext != 'pdf'){
				alert("You must attach a PDF only.");
				return false;
			}	
			else if($scope.attachments.length &gt; 1){
				alert("You can attach only 1 file.");
				return false;
			}
			else{			
				$scope.data.sc_cat_item.item_action = "order";
				$scope.data.sc_cat_item.quantity = c.quantity;
				if (g_form){
					g_form.submit();					 				
 					/*$timeout(function() {
						//$window.location.href="/scm/?id=scm_subconsultant_form&amp;table=x_icir_scm_subconsultant&amp;sys_id=" + $scope.invoiceSysID;						
 				   }, 1000, false);		*/	/*							
				}				
			}	
			*/
		}	
		
		
	}

	// order / create request
	function getOne() {
		$scope.server.get({
			action: 'log_request',
			itemDetails: {sys_id: $scope.data.sc_cat_item.sys_id, 
										name: $scope.data.sc_cat_item.name,
										sys_class_name: $scope.data.sc_cat_item.sys_class_name}
		});

		if ($scope.data.sys_properties.twostep &amp;&amp; $scope.data.sc_cat_item.sys_class_name != "sc_cat_item_producer") {
			$scope.server.get({
				cart: 'cart_' + $scope.data.sc_cat_item.sys_id,
				itemDetails: {sys_id: $scope.data.sc_cat_item.sys_id, quantity: $scope.data.sc_cat_item.quantity, fields: getVarData($scope.data.sc_cat_item._fields), newRecordID: $scope.data._generatedItemGUID},
				action: $scope.data.is_wishlist_item ? "order_wishlist_item" : "order_item"
			}).then(function(response) {
				var orderItemModalCtrl;
				var unregister = $scope.$on('$sp.service_catalog.cart.place_order', function(){
					orderItemModalCtrl.close();
				});

				var orderItemModal = angular.copy(response.data.orderItemModal);
				orderItemModal.options.afterOpen = function(ctrl){
					orderItemModalCtrl = ctrl;
				};
				orderItemModal.options.afterClose = function() {
					unregister();
					c.orderItemModal = null;
					orderItemModalCtrl = null;
				};
				c.orderItemModal = orderItemModal;
			});
		} else {
			postCatalogFormRequest().then(function(response) {
				var a = response.data.result;
				
				
				$scope.$emit("$$uiNotification", a.$$uiNotification);
				$scope.$emit("$sp.sc_cat_item.submitted", a);
				if ($scope.data.is_wishlist_item)
					$rootScope.$broadcast("$sp.service_catalog.wishlist.update");
				if (a.number)
					handleRedirect(a.number, a.table, a.sys_id, a.redirect_to, a.redirect_portal_url);
				$scope.submitting = false;
				$scope.submitButtonMsg = $scope.m.submittedMsg;
			});
		}
	}

	function addToCart() {
		$scope.server.get({
			action: 'log_request',
			itemDetails: {sys_id: $scope.data.sc_cat_item.sys_id, 
										name: $scope.data.sc_cat_item.name,
										sys_class_name: $scope.data.sc_cat_item.sys_class_name}
		});
		
		postCatalogFormRequest().then(function(response) {
			$rootScope.$broadcast("$sp.service_catalog.cart.add_item");
			$rootScope.$broadcast("$sp.service_catalog.cart.update");
			$scope.$emit("$sp.sc_cat_item.add_to_cart");
			if ($scope.data.is_wishlist_item) {
				$rootScope.$broadcast("$sp.service_catalog.wishlist.update");
				$scope.data.is_wishlist_item = false;
			}
			c.status = i18n.getMessage("Added item to shopping cart");
			$scope.server.get({action: 'init_item'}).then(function(response) {
				$scope.data._generatedItemGUID = response.data._generatedItemGUID;
				ah.setParams($scope.data._attachmentTable, $scope.data._generatedItemGUID, 1024 * 1024 * $scope.data.maxAttachmentSize);
				$scope.attachmentHandler.getAttachmentList();
				$scope.m.actionMsg = $scope.m.cartAddMsg + addLink('?id=sc_cart', $scope.m.viewCartMsg);
				$scope.m.actionMsg += '&lt;i class="fa fa-close pull-right pointer" ng-click="c.hideCartMsg()"/&gt;';
				$scope.m.actionMsg = $sce.trustAsHtml($scope.m.actionMsg);
				$scope.data.showMsg = true;
				$scope.submitting = false;
				spUtil.scrollTo('#sc_cat_item', 300);
			});
		});
	}

	function updateCart() {
		postCatalogFormRequest().then(function(response) {
			c.status = i18n.getMessage("Updated Item to shopping cart.");
			$window.location.href = '?id=sc_cart';
		})
	}

	function postCatalogFormRequest() {
		$scope.submitting = true;
		if ($scope.data.is_wishlist_item) {
			$scope.is_update_wishlist = false;
			$scope.data.show_wishlist_msg = false;
			if ($scope.data.sc_cat_item.sys_class_name === "sc_cat_item_producer")
				return spScUtil.submitWishlistedProducer($scope.data.sc_cat_item.sys_id, getVarData($scope.data.sc_cat_item._fields), $scope.data._generatedItemGUID);
			else if ($scope.data.sc_cat_item.item_action === "order")
				return spScUtil.orderWishlistedItem($scope.data.sc_cat_item.sys_id, $scope.data.sc_cat_item.quantity, getVarData($scope.data.sc_cat_item._fields), $scope.data._generatedItemGUID);
			else if ($scope.data.sc_cat_item.item_action === "add_to_cart")
				return spScUtil.addWishlistedItemToCart($scope.data.sc_cat_item.sys_id, $scope.data.sc_cat_item.quantity, getVarData($scope.data.sc_cat_item._fields), $scope.data._generatedItemGUID);
		}
		else if ($scope.data.is_cart_item)
			return spScUtil.updateCart($scope.data._generatedItemGUID, $scope.data.sc_cat_item.quantity, getVarData($scope.data.sc_cat_item._fields));
		else if ($scope.data.sc_cat_item.sys_class_name === "sc_cat_item_producer")
			return spScUtil.submitProducer($scope.data.sc_cat_item.sys_id, getVarData($scope.data.sc_cat_item._fields), $scope.data._generatedItemGUID);
		else if ($scope.data.sc_cat_item.item_action === "order")
			return spScUtil.orderNow($scope.data.sc_cat_item.sys_id, $scope.data.sc_cat_item.quantity, getVarData($scope.data.sc_cat_item._fields), $scope.data._generatedItemGUID);
		else if ($scope.data.sc_cat_item.item_action === "add_to_cart")
			return spScUtil.addToCart($scope.data.sc_cat_item.sys_id, $scope.data.sc_cat_item.quantity, getVarData($scope.data.sc_cat_item._fields), $scope.data._generatedItemGUID);
	}

	// spModel populates mandatory - hasMandatory is called by the submit button
	$scope.hasMandatory = function() {
		return c.mandatory &amp;&amp; c.mandatory.length &gt; 0;
	};

	// switch catalog items
	var unregister = $scope.$on('$sp.list.click', onListClick);
	$scope.$on("$destroy", function() {
		$rootScope.$broadcast("$sp.service_catalog.item.close");
		unregister();
	});

	function onListClick(evt, arg) {
		$scope.data.sys_id = arg.sys_id;
		spUtil.update($scope);
	}

	function handleRedirect(n, table, sys_id, redirectTo, redirectUrl) {
		var page = table == 'sc_request' ? 'sc_request' : 'ticket';
		
		if (redirectTo == 'catalog_home') 
			page = 'sc_home';
		if (c.options.page) {page = c.options.page;}
		if (c.options.table) {table = c.options.table;}
		//AK : redirect to created invoice
		//$window.location.href="/vcm?id=vcm_invoice_form&amp;table=x_icir_vcm_invoices&amp;sys_id=" + sys_id;	
		
		var url = spUtil.format(c.options.url, {page: page, table: table, sys_id: sys_id});
		if ($scope.data.sc_cat_item.sys_class_name === "sc_cat_item_producer") {
// 			if (redirectUrl)
// 				$window.location.href = redirectUrl;
// 			else
// 				$window.location.href = url;
// 			return;
		}
		
		
		//$window.location.href = spUtil.format(c.options.url, {page: 'sc_request', table:'sc_request', sys_id: sys_id});
		return;
	}
    
    $timeout(function() {
        if ($document[0].getElementsByClassName('sc-sticky-item-header').length &gt; 0) {
            var titleHeight = $document[0].getElementsByClassName('sc-sticky-item-header')[0].clientHeight;
            $scope.stickyHeaderTop = '-' + (titleHeight - 20 - $document[0].getElementsByClassName('sc-cat-item-short-description')[0].clientHeight) + 'px;';
        }
    });
}]]&gt;&lt;/client_script&gt;&lt;controller_as&gt;c&lt;/controller_as&gt;&lt;css&gt;.panel-button {
  float: none;
}
.wrapper-md {
  padding: 20px !important;
  background: #f9faf7;
}
label{
 	font-weight: bold !important;
  color:#5a5a5a;
}
.m-b-sm{
  font-weight: bold !important;
}
.sp-attachment-add {
  padding: 5px;
}

.p-t-none {
  padding-top: 0 !important;
}

.file-list-wrap {
	margin-bottom: 10px;
}

.sc-btn {
  color: $text-color;
}

.dismiss-button {
  position: absolute;
  top: 1rem;
	right: 10px;
	color: $text-color;
	cursor: pointer;
}

.item-header {
  padding-top: 10px !important;
  padding-bottom: 10px !important;
}

.sc-sticky-item-header {
  position: sticky;
  position: -webkit-sticky;
  position: -ms-sticky;
  top: -($font-size-h2 + $font-size-base);
  z-index: 10;
  background:url(lynx-record-producer-bg.jpg) no-repeat bottom right #9293b6;
  color:#161736;
  border-radius: 4px 4px 0 0;
  height:120px;
}
.m-b-sm{
 	font-weight:500; 
}
.text-muted{
 	color:#fff !important; 
}
.sc-fixed {
  position: fixed;
  max-height: 100%;
  width: 17.67777%;
}
.no-margin {
	margin: 0px; 
}
.sc-item-error-messages {
  max-height: 100%;
  position: absolute;
  overflow-y: auto;
  overflow-x: hidden;
  width: 100%; 
}
.sc-field-error-label {
  margin-right: .5em; 
  display: inline-block;
  cursor: pointer;
}
.image-gallery {
  font-size: 8px;
  color: #CECECE;
  .active {
    color: #717171;
  }
  i {
    padding: 0 5px;
  }
}
.relative {
  position: relative;
}
.sc-order-widget-btn {
   position: absolute;
   left: 9%;
   top: 10px
}
@media only screen and (max-width : 992px) {
  .sc-fixed {
    position: relative;
    width: 100%;
  }
  .wishlist-update-message {
    display : block;
  }
  .sc-item-error-messages {
    position: relative;
  }
  .read-more, .read-less {
    font-size: 15px;
    cursor: pointer;
  }
  .more-text {
    display: none;
  }
  .inline-cart {
    display: none;
  }
  .right-side-cart {
    display: inherit !important;
  }
}
@media only screen and (max-width : 768px) {
  .sc-sticky-item-header {
     position: inherit;
  }
  
}
.inline-cart {
  .quantity-selector {
    display: inline-block;
    width: 65px;
    padding-top: 2px;
  }
}

.add-on &amp;gt; button.lookup {
  display:none;
}
.field-has-reference .reference {
       display: block;
}&lt;/css&gt;&lt;data_table&gt;sp_instance&lt;/data_table&gt;&lt;demo_data/&gt;&lt;description/&gt;&lt;docs/&gt;&lt;field_list&gt;color&lt;/field_list&gt;&lt;has_preview&gt;true&lt;/has_preview&gt;&lt;id/&gt;&lt;internal&gt;false&lt;/internal&gt;&lt;link&gt;&lt;![CDATA[function(scope, elem){
    scope.setFocusToAttachment = function () {
		setTimeout(function () {
			var inboxArray = elem.find("a.view-attachment");
			inboxArray.focus();
		}, 100);
	}
}
]]&gt;&lt;/link&gt;&lt;name&gt;VCM Invoice SC Catalog Item&lt;/name&gt;&lt;option_schema&gt;[{"name":"show_add_cart_button","label":"Show Add Cart Button","type":"boolean"},{"hint":"If you turn on this, you will be able to see field validation messages on right side","name":"show_field_validation_messages","default_value":"true","label":"Show field validation messages","type":"boolean"},{"hint":"Show Add/Update Wish List buttons","name":"show_add_to_wishlist_button","default_value":"true","label":"Show Add/Update Wish List buttons","type":"boolean"},{"hint":"Order item section on top. If you uncheck this, order section will be displayed at bottom of screen","name":"display_cart_on_right","default_value":"true","label":"Order Item Section On Top","type":"boolean"},{"hint":"Show item description in few words with an option to read more","name":"show_less_description","default_value":"true","label":"Enable Show More/Less for Item description on Mobile","type":"boolean"}]&lt;/option_schema&gt;&lt;public&gt;false&lt;/public&gt;&lt;roles/&gt;&lt;script&gt;&lt;![CDATA[// populate the 'data' variable with catalog item, variables, and variable view
(function() {
	if (input &amp;&amp; input.action == 'init_item') {
		data._generatedItemGUID = gs.generateGUID();
		return;
	}
	else if (input &amp;&amp; input.action === "order_item") {
		data.orderItemModal = $sp.getWidget('widget-modal', {embeddedWidgetId: 'sc-checkout', embeddedWidgetOptions: {cart: {name: input.cart}, action: 'order_now', item: input.itemDetails, requested_for: {id:options.requested_for_id, displayValue:options.requested_for_display}
																																																								 }, backdrop: 'static', keyboard: false, size: 'md'});
		return;
	} else if (input &amp;&amp; input.action == "order_wishlist_item") {
		data.orderItemModal = $sp.getWidget('widget-modal', {embeddedWidgetId: 'sc-checkout', embeddedWidgetOptions: {cart: {name: input.cart}, action: 'order_now_wishlisted_item', item: input.itemDetails, requested_for: {id:options.requested_for_id, displayValue:options.requested_for_display}
																																																								 }, backdrop: 'static', keyboard: false, size: 'md'});
		return;
	} else if (input &amp;&amp; input.action === 'log_request') {
		 $sp.logStat('Cat Item Request', input.itemDetails.sys_class_name, input.itemDetails.sys_id, input.itemDetails.name);
		 return;
	}
	
	// portal can specify a catalog and catalog category home page
	data.sc_catalog_page = $sp.getDisplayValue("sc_catalog_page") || "sc_home";
	data.sc_category_page = $sp.getDisplayValue("sc_category_page") || "sc_category";
	data.sc_catalog = $sp.getDisplayValue('sc_catalog');
	var edit_parm = $sp.getParameter('edit');
	data.is_cart_item = edit_parm == 'cart';
	data.is_wishlist_item = edit_parm == 'wishlist';
	data.show_wishlist_msg = false;
	data.recordFound = true;

	options.show_add_cart_button = (options.show_add_cart_button == "true");

	if (options.page) {
		var pageGR = new GlideRecord("sp_page");
		options.page = (pageGR.get(options.page)) ? pageGR.getValue("id") : null;
	}

	if (options.table) {
		var tableGR = new GlideRecord("sys_db_object");
		options.table = (tableGR.get(options.table)) ? tableGR.getValue("name") : null;
	}

	options.url = options.url || "?id={page}&amp;is_new_order=true&amp;table={table}&amp;sys_id={sys_id}";
	data.showPrices = $sp.showCatalogPrices();
	var m = data.msgs = {};
	m.submitMsg = gs.getMessage("Submit");
	m.orderNowMsg = gs.getMessage("Order Now");
	m.submittedMsg = gs.getMessage("Submitted");
	m.createdMsg = gs.getMessage("Created");
	m.trackMsg = gs.getMessage("track using 'Requests' in the header or");
	m.clickMsg = gs.getMessage("click here to view");
	m.dialogTitle = gs.getMessage("Delete Attachment");
	m.dialogMessage = gs.getMessage("Are you sure?");
	m.dialogOK = gs.getMessage("OK");
	m.dialogCancel = gs.getMessage("Cancel");
	
	m.renameSuccessMsg = gs.getMessage("Attachment renamed successfully");
	m.deleteSuccessMsg = gs.getMessage("Attachment deleted successfully");
	m.wishlistMsg = gs.getMessage('Wish List');
	m.cartMsg = gs.getMessage('Cart');
	m.itemWishlistMsg = gs.getMessage('This item is already in your Wish List. If you attempt to add this item to your Wish List it will overwrite the existing item.');
	m.invalidRecordMsg = gs.getMessage('You are either not authorized or record is not valid.');
	m.wishlistUpdateMsg = gs.getMessage('Your Wish List has been updated.');
	m.wishlistAddMsg = gs.getMessage('Your item has been added to your Wish List.');
	m.cartAddMsg = gs.getMessage('Your item has been added to your Cart. To make changes to the items in your cart, click ');
	m.viewWishListMsg = gs.getMessage('View Wish List');
	m.viewCartMsg = gs.getMessage('View Cart');

	data.maxAttachmentSize = parseInt(gs.getProperty("com.glide.attachment.max_size", 1024));
	if (isNaN(data.maxAttachmentSize))
		data.maxAttachmentSize = 24;
	m.largeAttachmentMsg = gs.getMessage("Attached files must be smaller than {0} - please try again", "" + data.maxAttachmentSize + "MB");
	
	var cartName = data.is_cart_item ? 'DEFAULT' : 'saved_items';
	var cart = new sn_sc.CartJS(cartName);

	data.showWishlist = new sn_sc.Catalog('' + $sp.getValue('sc_catalog')).isWishlistEnabled();
	
	if (edit_parm) {
		var cart_item_id = $sp.getParameter("sys_id");
		var gr = new GlideRecord("sc_cart_item");
		if (!gr.get(cart_item_id) || gr.cart != cart.getCartID()) {
			data.recordFound = false;
			return;
		}
		var catItemData = {};
		catItemData.sys_id = gr.getValue('cat_item');
		catItemData.cart_item_id = gr.getUniqueValue();
		catItemData.table = "sc_cart_item";
		catItemData.is_ordering = !!options.isOrdering;

		data.sc_cat_item = $sp.getCatalogItem(catItemData);
		data.sc_cat_item.isCartItem = true;
		var values = getValues(cart_item_id);

		for(var f in data.sc_cat_item._fields) {
			// Put the values into the cat item fields
			var field = data.sc_cat_item._fields[f];
			if (typeof values[f] != "undefined" &amp;&amp; typeof values[f].value != "undefined") {
				if (values[f].type == 9 || values[f].type == 10)
					field.value = values[f].displayValue;
				else
					field.value = values[f].value;
				field.displayValue = values[f].displayValue;
				field.display_value_list = values[f].display_value_list;
			}
			updatePriceOnField(field);
				
		}
		data._generatedItemGUID = cart_item_id;
		data.quantity = '' + gr.quantity;
	} else {
	
		if (input)
			data.sys_id = input.sys_id;
		else if (options.sys_id)
			data.sys_id = options.sys_id;
		else
			data.sys_id = $sp.getParameter("sys_id") || $sp.getParameter('sl_sys_id');
	
		if (!data.sys_id) {
			data.recordFound = false;
			return;
		}
	
		data._generatedItemGUID = gs.generateGUID();
		var validatedItem = new sn_sc.CatItem('' + data.sys_id);
		if (!validatedItem.canView() || !validatedItem.isVisibleServicePortal()) {
			data.recordFound = false;
			return;
		}
	
		data.sc_cat_item = $sp.getCatalogItem(data.sys_id, true);
		if (data.sc_cat_item.category) {
			var categoryJS;
			var categoryID = data.sc_cat_item.category;
			if ($sp.getParameter("sysparm_category")) {
				categoryJS = new sn_sc.CatCategory($sp.getParameter("sysparm_category") + "");
				categoryID = $sp.getParameter("sysparm_category") + "";
			}
			else {
				categoryJS = new sn_sc.CatCategory(data.sc_cat_item.category);
			}
			data.category = {
				name: categoryJS.getTitle(),
				url: categoryJS.canView() ? '?id=' + data.sc_category_page + '&amp;sys_id=' + categoryID : "#"
			}
			data.categories = [];
			data.categories.push({
				label: categoryJS.getTitle(),
				url: categoryJS.canView() ? '?id=' + data.sc_category_page + '&amp;sys_id=' + categoryID : "#"
			});
			while(categoryJS &amp;&amp; categoryJS.getParent()) {
				var parentId =  categoryJS.getParent();
				categoryJS = new sn_sc.CatCategory(parentId);
				var category = {
					label: categoryJS.getTitle(),
					url: categoryJS.canView() ? '?id=' + data.sc_category_page + '&amp;sys_id=' + parentId : "#"
				};
				data.categories.unshift(category);
			}
		}
		var gr = new GlideRecord('sc_cart_item');
		gr.addQuery('cart', cart.getCartID());
		gr.addQuery('cat_item', data.sys_id);
		gr.query();
		if (gr.next())
			data.show_wishlist_msg = true;
	}

	data.sys_properties = {
		twostep: gs.getProperty("glide.sc.sp.twostep", "true") == 'true'
	};

	var athTblName = 'sc_cart_item';
	var className = data.sc_cat_item.sys_class_name;
	if (!new global.CatalogItemTypeProcessor().canCreateNormalCartItem(className)) {
		if (className == 'sc_cat_item_producer') {
				var gr = new GlideRecord('sc_cat_item_producer');
				gr.get(data.sc_cat_item.sys_id);
				if (gr.isValidRecord())
					athTblName = gr.getValue('table_name');
		}
	}
	data._attachmentTable = athTblName;

	$sp.logStat('Cat Item View', data.sc_cat_item.sys_class_name, data.sc_cat_item.sys_id, data.sc_cat_item.name);
	
	function getValues(sys_id) {
		var qs = new sn_sc.VariablePoolQuestionSetJS();
		qs.setCartID(sys_id);
		qs.load();
		var values = {};
		var questions = qs.getFlatQuestions();
		for (var i = 0; i &lt; questions.length; i++)
			values["IO:" + questions[i].sys_id] = questions[i];
		return values;
	}

	function setPrice(field, p, rp) {
		if (p != undefined)
			field.price = p;
		if (rp != undefined)
			field.recurring_price = rp;
	}

	function updatePriceForReferenceTable(field) {
		var tableName = field.refTable + '';
		if (tableName != undefined &amp;&amp; tableName != null &amp;&amp; tableName != '') {
			var gr = new GlideRecord(tableName);
			if (gr.isValid()) {
				if (gr.get(field.value) &amp;&amp; gr.isValidRecord()) {
					updatePrice(gr, field);
					updateRecurringPrice(gr, field);
				}
			}
		}
	}

	function updatePriceForListCollector(field) {
		var tableName = field.refTable + '';
		if (tableName != undefined &amp;&amp; tableName != null &amp;&amp; tableName != '') {
			var gr = new GlideRecord(tableName);
			if (gr.isValid()) {
				var values = field.value.split(',');
				gr.addQuery('sys_id', values);
				gr.query();
				var p = 0.0;
				var rp = 0.0;
				var price_value_list = [];
				while(gr.next()) {
						var price_field = {};
						updatePrice(gr, price_field);
						updateRecurringPrice(gr, price_field);
						if (price_field.price)
							p += Number(price_field.price);
						else
							price_field.price = 0.0;
						if (price_field.recurring_price)
							rp += Number(price_field.recurring_price);
						else
							price_field.recurring_price = 0.0;
						price_value_list.push(price_field);
				}
				field.price = p;
				field.recurring_price = rp;
				field.price_value_list = price_value_list;
			}
		}
	}

	function updatePrice(gr, field) {
		if (gr.isValidField('price'))
			field.price = gr.getValue('price');
		else if (gr.isValidField('u_price'))
			field.price = gr.getValue('u_price');
	}

	function updateRecurringPrice(gr, field) {
		if (gr.isValidField('recurring_price'))
			field.recurring_price = gr.getValue('recurring_price');
		else if (gr.isValidField('u_recurring_price'))
			field.recurring_price = gr.getValue('u_recurring_price');
	}

	function updatePriceOnField(field) {
		if (field.type == 'boolean' || field.type == 'boolean_confirm') {
			if (field.value == 'true' || field.value == true)
				setPrice(field, field._pricing.price_if_checked, field._pricing.recurring_price_if_checked);
			else
				setPrice(field, 0, 0);
		} else if (field.choices) {
			field.choices.forEach( function(choice) {
				if (choice.value +'' == field.value + '')
					 setPrice(field, choice.price, choice.recurring_price);
			});
		} else if (field._pricing &amp;&amp; field._pricing.pricing_implications === true) {
			if (field.type == 'reference') 
				updatePriceForReferenceTable(field);
			else if (field.type == 'glide_list')
				updatePriceForListCollector(field);
		}
	}
})()
]]&gt;&lt;/script&gt;&lt;servicenow&gt;false&lt;/servicenow&gt;&lt;sys_class_name&gt;sp_widget&lt;/sys_class_name&gt;&lt;sys_created_by&gt;Anagha.Kunjeer@infocenter.io&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2019-02-07 02:17:23&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;eac7f654db6b2f00ccd6f2f5ab9619da&lt;/sys_id&gt;&lt;sys_mod_count&gt;12&lt;/sys_mod_count&gt;&lt;sys_name&gt;VCM Invoice SC Catalog Item&lt;/sys_name&gt;&lt;sys_package display_value="Vendor Contract Management" source="x_icir_vcm"&gt;3fe81872db2caf40c203a2364b9619e0&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Vendor Contract Management"&gt;3fe81872db2caf40c203a2364b9619e0&lt;/sys_scope&gt;&lt;sys_update_name&gt;sp_widget_eac7f654db6b2f00ccd6f2f5ab9619da&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;Anagha.Kunjeer@infocenter.io&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2019-02-07 05:40:45&lt;/sys_updated_on&gt;&lt;template&gt;&lt;![CDATA[&lt;div id="sc_cat_item" ng-if="::data.recordFound"&gt;
  &lt;sp-widget widget="c.orderItemModal" ng-if="c.orderItemModal"&gt;&lt;/sp-widget&gt;
  &lt;div class="row" ng-if="::data.sc_cat_item" &gt;
    &lt;div class="col-sm-12" ng-class="{true: 'col-md-9', false: 'col-md-12'}[options.display_cart_on_right === 'true']" id="catItemTop"&gt;
      &lt;!-- Info Message Box --&gt;
      &lt;div ng-if="data.show_wishlist_msg" class="alert alert-info"&gt;
        	{{::m.itemWishlistMsg}}
      &lt;/div&gt;
      &lt;!--	Success Message Box	--&gt;
      &lt;div class="alert alert-success" ng-if="data.showMsg" sc-bind-html-compile="m.actionMsg"&gt;
      &lt;/div&gt;
     &lt;div class="panel panel-default"&gt;
        &lt;!-- Title Section --&gt;
        &lt;div class="wrapper-md b-b break-word item-header" ng-class="{true: '', false: 'sc-sticky-item-header'}[!c.data.sc_cat_item.short_description]" style="top: {{stickyHeaderTop}}"&gt;
        	&lt;!--&lt;h1 class="h2 m-t-none m-b-sm font-thin" ng-if="::data.sc_cat_item.name"&gt;{{::data.sc_cat_item.name}}&lt;/h1&gt;--&gt;
          &lt;h1 class="h2 m-t-none m-b-sm font-thin" ng-if="::data.sc_cat_item.name"&gt;Invoice&lt;/h1&gt;
        	&lt;!--&lt;div class="text-muted sc-cat-item-short-description" ng-if="::data.sc_cat_item.short_description"&gt;{{::data.sc_cat_item.short_description}}&lt;/div&gt;--&gt;
      	&lt;/div&gt;
        &lt;div class="wrapper-md row b-b no-margin" ng-if="c.data.sc_cat_item.picture || c.data.sc_cat_item.description"&gt;
          &lt;div class="col-sm-4 col-xs-12 no-padder" ng-if="c.data.sc_cat_item.picture"&gt;
            &lt;div class="wrapper-md text-center"&gt;
              &lt;i class="fa fa-chevron-left pointer" style="position:absolute; top:50%; left:4%; color:#CECECE" ng-if="options.image_gallery"&gt;&lt;/i&gt;
              &lt;img class="img-responsive catalog-item-image" alt="{{::data.sc_cat_item.name}}" style="display: inline" ng-src="{{::data.sc_cat_item.picture}}?t=medium" /&gt;
              &lt;i class="fa fa-chevron-right pointer" style="position:absolute; top:50%; right:4%; color:#CECECE" ng-if="options.image_gallery"&gt;&lt;/i&gt;
              &lt;div class="image-gallery padding-top" ng-if="options.image_gallery"&gt;
                &lt;i class="fa fa-circle active"&gt;&lt;/i&gt;
                &lt;i class="fa fa-circle"&gt;&lt;/i&gt;
                &lt;i class="fa fa-circle"&gt;&lt;/i&gt;
              &lt;/div&gt;
            &lt;/div&gt;
          &lt;/div&gt;
          &lt;div class="col-xs-12 padder-md break-word"
               ng-class="{true: 'col-sm-12 no-padder', false: 'col-sm-8'}[!c.data.sc_cat_item.picture]"&gt;
            &lt;div class="visible-md visible-lg" ng-class="{false : 'visible-xs visible-sm', true : 'hidden-xs hidden-sm'}[c.options.show_less_description === 'true']"&gt;
              &lt;div ng-bind-html="::data.sc_cat_item.description"&gt;&lt;/div&gt;
            &lt;/div&gt;
            &lt;div class="col-xs-12 col-sm-12 visible-xs visible-sm" ng-if="c.options.show_less_description === 'true'"&gt;
              &lt;sc-toggle-data sn-data="::data.sc_cat_item.description"&gt;&lt;/sc-toggle-data&gt;
        		&lt;/div&gt;
          &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class="" ng-class="{'b-b wrapper-md': !data.no_fields}"&gt;
          &lt;sp-cat-item item="::data.sc_cat_item" &gt;&lt;/sp-cat-item&gt;
          &lt;form&gt;
            &lt;!-- display view and model --&gt;
            &lt;sp-model form-model="::data.sc_cat_item" mandatory="c.mandatory"&gt;&lt;/sp-model&gt;
          &lt;/form&gt;
        &lt;/div&gt;
        &lt;!-- Bottom cart --&gt;
        &lt;div class="inline-cart" ng-if="::options.display_cart_on_right !== 'true'"&gt;
          &lt;div ng-if="data.sc_cat_item.sys_class_name != 'sc_cat_item_content'" class="wrapper-md b-b"&gt;
              &lt;div class="m-b text-right" ng-if="data.showPrices &amp;&amp; (data.sc_cat_item.price || data.sc_cat_item.recurring_price)" &gt;
               &lt;b&gt;${Price}:&lt;/b&gt; {{data.sc_cat_item.price}}&lt;em ng-if="data.sc_cat_item.recurring_price" class="cat_item_price"&gt; + {{data.sc_cat_item.recurring_price}}&lt;/em&gt;
              &lt;/div&gt;
              &lt;div ng-if="::c.allowOrder()" class="text-right"&gt;
                &lt;select ng-if="c.showQuantitySelector()"
                        ng-disabled="submitting"
                        class="form-control quantity-selector m-r-xs"
                        ng-model="c.quantity"
                        aria-label="${Quantity}"
                        ng-options="num for num in [1,2,3,4,5,6,7,8,9,10]"&gt;
                &lt;/select&gt;
                &lt;button tabindex="0" ng-if="c.showAddCartBtn()" name="add_to_cart" ng-disabled="submitting" ng-click="triggerAddToCart()" class="btn btn-default m-r-xs"&gt;
                  &lt;i class="fa fa fa-shopping-cart m-r-xs"&gt;&lt;/i&gt;
                  ${Add to Cart}
                &lt;/button&gt;
                &lt;button tabindex="0" ng-if="data.is_cart_item" name="update" ng-disabled="submitting" ng-click="triggerUpdateCart()" class="btn btn-default"&gt;
                  &lt;i class="fa fa fa-shopping-cart m-r-xs"&gt;&lt;/i&gt;
                  ${Update Cart}
                &lt;/button&gt;
                &lt;span class="form-group relative" ng-if="data.showWishlist &amp;&amp; !data.is_cart_item &amp;&amp; c.options.show_add_to_wishlist_button === 'true'"&gt;
                  &lt;button ng-if="!data.is_wishlist_item" name="add_to_wishlist" ng-click="addToWishlist()" ng-disabled="submitting" class="btn btn-default m-r-xs"&gt;
                    &lt;i class="icon icon-sp-wishlist m-r-xs" style="vertical-align: text-bottom;"&gt;&lt;/i&gt;
                    ${Add to Wish List}
                  &lt;/button&gt;
                  &lt;button ng-if="data.is_wishlist_item" name="update_wishlist" ng-click="addToWishlist()" ng-disabled="submitting" class="btn btn-default m-r-xs"&gt;
                    &lt;i class="icon icon-sp-wishlist m-r-xs" style="vertical-align: text-bottom;"&gt;&lt;/i&gt;
                    ${Update Wish List}
                  &lt;/button&gt;
                &lt;/span&gt;
								&lt;button ng-if="::c.showOrderNowButton()" tabindex="0" name="submit" ng-disabled="submitting" ng-click="triggerOnSubmit()" class="btn btn-primary"&gt;{{::submitButtonMsg}}&lt;/button&gt;
                &lt;span ng-if="submitting" style="padding-left:4px"&gt;${Submitting...}&lt;/span&gt;
              &lt;/div&gt;
              &lt;div ng-show="hasMandatory(c.mandatory)" class="alert alert-info" style="margin-top: .5em" ng-if="c.options.show_field_validation_messages === 'true'"&gt;
                &lt;span ng-if="hasMandatory(mandatory)"&gt;${Required information} &lt;/span&gt;
                &lt;label ng-repeat="f in c.mandatory" for="sp_formfield_{{::f.catalogFieldName}}" class="label label-danger sc-field-error-label" style="margin-right: .5em; display: inline-block;"&gt;{{::f.label}}&lt;/label&gt;
              &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class="wrapper-md row no-margin"&gt;
          &lt;now-attachments-list template="sp_attachment_single_line" &gt;&lt;/now-attachments-list&gt;
          &lt;label ng-if="!submitting" style="float:right;font-weight:normal;cursor:pointer;"&gt;
            &lt;sp-attachment-button&gt;&lt;/sp-attachment-button&gt;
            &lt;span style="padding-left:4px;"&gt;${Add attachments}&lt;/span&gt;
          &lt;/label&gt;
          
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div ng-if="::data.sc_cat_item.content_type == 'external'" class="wrapper-md"&gt;
        &lt;a ng-href="{{::data.sc_cat_item.url}}" target={{::data.sc_cat_item.target}}&gt;{{::data.sc_cat_item.url}} ➚&lt;/a&gt;
      &lt;/div&gt;
			&lt;div ng-if="::data.sc_cat_item.content_type == 'kb'" class="wrapper-md"&gt;
        &lt;a  ng-href="?id=kb_article&amp;sys_id={{::data.sc_cat_item.kb_article}}"&gt;${Go to KB Article:} {{::data.sc_cat_item.kb_article_description}}&lt;/a&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;!-- Right side content --&gt;
    &lt;div class="col-sm-12 col-md-3 right-side-cart" ng-show="::options.display_cart_on_right === 'true'"&gt;
      &lt;!-- Right side cart( If you are chaning anything here, please change in bottom cart section also) --&gt;
      &lt;div ng-class="{true:'sc-fixed', false:'' }[options.display_cart_on_right === 'true']"&gt;
      	&lt;div ng-if="data.sc_cat_item.sys_class_name != 'sc_cat_item_content'" class="panel panel-{{::options.color}} b wrapper-md"&gt;
           &lt;div class="form-group" ng-if="::c.allowOrder()"&gt;
             &lt;select ng-if="c.showQuantitySelector()"
                     style="text-indent: 6px;"
                     ng-disabled="submitting"
                     class="form-control"
                     ng-model="c.quantity"
                     aria-label="${Quantity}"
                     ng-options="num for num in [1,2,3,4,5,6,7,8,9,10]"&gt;
             &lt;/select&gt;
           &lt;/div&gt;
           &lt;div class="form-group relative"&gt;
             &lt;button tabindex="0" ng-if="c.showAddCartBtn()" name="add_to_cart" ng-disabled="submitting" ng-click="triggerAddToCart()" class="btn btn-default sc-btn form-control"&gt;
               &lt;i class="fa fa fa-shopping-cart sc-order-widget-btn pull-left"&gt;&lt;/i&gt;
               ${Add to Cart}
             &lt;/button&gt;
             &lt;button tabindex="0" ng-if="data.is_cart_item" name="update" ng-disabled="submitting" ng-click="triggerUpdateCart()" class="btn btn-default sc-btn form-control"&gt;
               &lt;i class="fa fa fa-shopping-cart sc-order-widget-btn pull-left"&gt;&lt;/i&gt;
               ${Update Cart}
             &lt;/button&gt;
           &lt;/div&gt;
           &lt;div class="form-group relative" ng-if="data.showWishlist &amp;&amp; !data.is_cart_item &amp;&amp; c.options.show_add_to_wishlist_button === 'true'"&gt;
             &lt;button ng-if="!data.is_wishlist_item" name="add_to_wishlist" ng-click="addToWishlist()" ng-disabled="submitting" class="btn btn-default sc-btn form-control"&gt;
               &lt;i class="icon icon-sp-wishlist sc-order-widget-btn pull-left" style="top:5px"&gt;&lt;/i&gt;
               ${Add to Wish List}
             &lt;/button&gt;
             &lt;button ng-if="data.is_wishlist_item" name="update_wishlist" ng-click="addToWishlist()" ng-disabled="submitting" class="btn btn-default sc-btn form-control"&gt;
             	&lt;i class="icon icon-sp-wishlist sc-order-widget-btn pull-left" style="top:5px"&gt;&lt;/i&gt;
             	${Update Wish List}
             &lt;/button&gt;
           &lt;/div&gt;
           &lt;div class="form-group" ng-if="data.showPrices &amp;&amp; data.sc_cat_item.price"&gt;
             &lt;b&gt;${Price}:&lt;/b&gt; {{data.sc_cat_item.price}}&lt;em ng-if="data.sc_cat_item.recurring_price" class="cat_item_price"&gt; + {{data.sc_cat_item.recurring_price}}&lt;/em&gt;
           &lt;/div&gt;
           &lt;div class="form-group"&gt;
             &lt;button ng-if="::c.showOrderNowButton()" tabindex="0" name="submit" ng-disabled="submitting" ng-click="triggerOnSubmit()" class="btn btn-primary btn-block"&gt;{{::submitButtonMsg}}&lt;/button&gt;
             &lt;span ng-if="submitting" style="padding-left:4px"&gt;${Submitting...}&lt;/span&gt;
           &lt;/div&gt;
         &lt;/div&gt;
      	&lt;div class="sc-item-error-messages" ng-if="c.options.show_field_validation_messages === 'true'"&gt;
            &lt;div class="row" ng-if="hasMandatory(c.mandatory)" class=" row alert alert-info" style="margin-top: .5em"&gt;
              &lt;div class="col-sm-12"&gt;
                &lt;div ng-if="hasMandatory(c.mandatory)"&gt;${Required information} &lt;/div&gt;
                &lt;label ng-repeat="f in c.mandatory" for="sp_formfield_{{::f.catalogFieldName}}" class="label label-danger sc-field-error-label"&gt;{{::f.label}}&lt;/label&gt;
              &lt;/div&gt;
           &lt;/div&gt;
         &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;sp-message-dialog name="delete_attachment"
                       title="{{::m.dialogTitle}}"
                       message="{{::m.dialogMessage}}"
                       ok="{{::m.dialogOK}}"
                       cancel="{{::m.dialogCancel}}"
                       dialog-class="delete-dialog"&gt;&lt;/sp-message-dialog&gt;
  &lt;div ng-if="::!data.sc_cat_item" &gt;
    &lt;div class="panel panel-default"&gt;
      &lt;div class="panel-heading"&gt;&lt;h4 class="panel-title"&gt;${Item not found}&lt;/h4&gt;&lt;/div&gt;
      &lt;div class="panel-body wrapper"&gt;
        &lt;p&gt;${This item is not found or currently not available}&lt;/p&gt;
        &lt;p&gt;${Suggestions}:&lt;/p&gt;
        &lt;ul&gt;
          &lt;li&gt;${Try searching for the item}&lt;/li&gt;
          &lt;li&gt;${Go to the Service Catalog homepage}&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;div class="sr-only" aria-live="assertive"&gt;{{::c.status}}&lt;/div&gt;
&lt;/div&gt;
&lt;div ng-if="::!data.recordFound" class="alert alert-info"&gt;{{::m.invalidRecordMsg}}&lt;/div&gt;
&lt;now-message key="Added item to shopping cart" value="${Added item to shopping cart}"/&gt;
]]&gt;&lt;/template&gt;&lt;/sp_widget&gt;&lt;/record_update&gt;</payload>
        <payload_hash>-664925975</payload_hash>
        <record_name>VCM Invoice SC Catalog Item</record_name>
        <reverted_from/>
        <source>640c41f7db17ab00c203a2364b9619cf</source>
        <source_table>sys_update_set</source_table>
        <state>previous</state>
        <sys_created_by>Anagha.Kunjeer@infocenter.io</sys_created_by>
        <sys_created_on>2019-02-07 05:40:45</sys_created_on>
        <sys_id>65566fd4db2f2f00ccd6f2f5ab9619ee</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_recorded_at>168c679024b0000001</sys_recorded_at>
        <sys_updated_by>Anagha.Kunjeer@infocenter.io</sys_updated_by>
        <sys_updated_on>2019-02-07 05:40:45</sys_updated_on>
        <type>Widget</type>
        <update_guid>2d566fd4e62f2f008dccee29295dcbed</update_guid>
        <update_guid_history>2d566fd4e62f2f008dccee29295dcbed:-664925975,bcf52bd4422f2f001f85e420ea80e8eb:-99539863,a9a9df94aeeb2f00c8afb2065088b592:-175269559,cb591b94f4eb2f003f118169f4c1f089:1277860026,2eb89394b1eb2f0037c9751661b67150:-1902215719,48264f54e9ab2f001c08b39830c78a06:-2141192065,7975031001ab2f00dc505fb8494c4ac5:-1176490447,28830310fbab2f00b0e47b800f83b480:-44196646,cd434fdc446b2f00eb5e7788915c3802:354233422,2b0ab6d4f86b2f002100a3dc745cd2dc:-1931112478,59e77e54b76b2f00577386d09f2cb921:785632802,c2d77e54ec6b2f0014f59855e1b2efa7:-1211546003,e6c7f654b36b2f00f653882d9daf00dc:-1738436011</update_guid_history>
    </sys_update_version>
    <sys_metadata_delete action="INSERT_OR_UPDATE">
        <sys_audit_delete display_value="Record deleted 2019-02-07 03:05:53">ef878820db672f00c203a2364b96190b</sys_audit_delete>
        <sys_class_name>sys_metadata_delete</sys_class_name>
        <sys_created_by>Anagha.Kunjeer@infocenter.io</sys_created_by>
        <sys_created_on>2019-02-07 08:05:53</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_db_object display_value="" name="sp_widget">sp_widget</sys_db_object>
        <sys_id>0121228278e3486480695407d1bb8810</sys_id>
        <sys_metadata>eac7f654db6b2f00ccd6f2f5ab9619da</sys_metadata>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>VCM Invoice SC Catalog Item</sys_name>
        <sys_package display_value="Vendor Contract Management" source="x_icir_vcm">3fe81872db2caf40c203a2364b9619e0</sys_package>
        <sys_parent/>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="Vendor Contract Management">3fe81872db2caf40c203a2364b9619e0</sys_scope>
        <sys_scope_delete display_value="">10f7e6901f8f47e69075d98c142de984</sys_scope_delete>
        <sys_update_name>sp_widget_eac7f654db6b2f00ccd6f2f5ab9619da</sys_update_name>
        <sys_update_version display_value="sp_widget_eac7f654db6b2f00ccd6f2f5ab9619da">65566fd4db2f2f00ccd6f2f5ab9619ee</sys_update_version>
        <sys_updated_by>Anagha.Kunjeer@infocenter.io</sys_updated_by>
        <sys_updated_on>2019-02-07 08:05:53</sys_updated_on>
    </sys_metadata_delete>
</record_update>
